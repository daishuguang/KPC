<?xml version="1.0" encoding="utf-8"?>
<configuration>
	<configSections>
		<section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=6.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
		<section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler, log4net" />
		<section name="hostServiceSettings" type="SNS.Apps.KPC.Libs.Configurations.HostServiceConfiguration, SNS.Apps.KPC.Libs.Configurations, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
		<section name="taskServiceSettings" type="SNS.Apps.KPC.Libs.Configurations.TaskServiceConfiguration, SNS.Apps.KPC.Libs.Configurations, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
		<section name="smsServiceSettings" type="SNS.Apps.KPC.Libs.Configurations.SMSServiceConfiguration, SNS.Apps.KPC.Libs.Configurations, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
	</configSections>

	<startup>
		<supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" />
	</startup>

	<connectionStrings>
		<add name="DataModels" connectionString="metadata=res://*/DataStores.DataModels.csdl|res://*/DataStores.DataModels.ssdl|res://*/DataStores.DataModels.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=.;initial catalog=SNS.Apps.KPC.V2;integrated security=True;multipleactiveresultsets=True;application name=EntityFramework&quot;" providerName="System.Data.EntityClient" />
		<add name="DataModels_Log" connectionString="metadata=res://*/DataStores_Log.DataModels.csdl|res://*/DataStores_Log.DataModels.ssdl|res://*/DataStores_Log.DataModels.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=.;initial catalog=SNS.Apps.KPC.V2.Log;integrated security=True;MultipleActiveResultSets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
	</connectionStrings>

	<appSettings>
		<!-- Common Settings -->
		<!-- For Debug Only, pls remove this node while publish -->
		<add key="Debug_Mode" value="false" />
		<add key="Debug_User" value="" />
		<add key="Trace_Mode" value="true" />
		<!-- End -->

		<add key="ImportData_Enabled" value="true" />
		<add key="ImportData_StartedID" value="1000000"/>

		<add key="ExternalData_Enabled" value="true" />
		<add key="ExternalData_StartedID" value="2000000"/>

		<add key="MemCache_ExpiresIn" value="20" />
		<add key="MemCache_Enabled" value="true" />

		<add key="Portraits_Folder" value="C:\inetpub\open.kuaipinche.com\content\portraits"/>
		<add key="Portraits_Image" value="/content/portraits/{0}/{1}.jpeg" />
		<add key="Portraits_ImageThumb" value="/content/portraits/{0}/thumbs/{1}.jpeg" />
		<add key="Portraits_ImageDefault" value="/content/portraits/default.jpg"/>
		<add key="Portraits_TempIcon" value="/content/portraits/temp/icon_{0:D4}.jpg" />
		<add key="Portraits_TempIcon_RangeMin" value="1"/>
		<add key="Portraits_TempIcon_RangeMax" value="431"/>

		<add key="WebRequest_UserAgent" value="Mozilla/5.0 (Linux; U; Android 4.3; zh-cn; SM-N9002 Build/JSS15J) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 MicroMessenger/5.1.360"/>
		<!-- End -->

		<!-- Baidu Map API -->
		<add key="MapAPIKey_Server" value="16f0929daf0ec892389af1e437224d9f" />
		<add key="MapAPIKey_Mobile" value="20dc8c88313b3b855b3dee43b9ede494" />
		<add key="MapAPIKey_Browser" value="6E27B637f88190dd00b6bcf9bb2f0c33" />
		<add key="Baidu_Location_Geocoding_URI" value="http://api.map.baidu.com/geocoder/v2/?ak={0}&amp;address={1}&amp;output=json" />
		<add key="Baidu_Location_Reverse_URI" value="http://api.map.baidu.com/geocoder/v2/?ak={0}&amp;location={1},{2}&amp;output=json&amp;pois=0" />
		<!-- End -->

		<!-- Task Service Settings -->
		<add key="TaskService_Interval" value="10" />
		<!-- End -->

		<!-- RouteMatrix Service Settings -->
		<add key="RouteMatrix_ExpiresInDays_CityWide" value="30" />
		<add key="RouteMatrix_ExpiresInDays_Intercity" value="365" />
		<add key="RouteMatrix_MatchRate" value="60" />
		<add key="RouteMatrix_MatchDist_Citywide" value="10" />
		<add key="RouteMatrix_MatchDist_Intercity" value="200" />
		<add key="RouteMatrix_MatchPerc_Intercity" value="0.1" />
		<!-- End -->

		<!-- WeChat Service Settings -->
		<add key="WeChat_MP_Account" value="kuaipinche" />
		<add key="WeChat_MP_Password" value="Kuai_mp123" />
		<!-- 公众号 -->
		<!--
		<add key="WeChat_MP_AppID" value="wxf20cdd91925855f1" />
		<add key="WeChat_MP_AppSecret" value="55fede0ceffdaafae48a5571a0fe717a" />
		-->
		<!-- 测试号 -->
		<add key="WeChat_MP_AppID" value="wxd946f6039772215d" />
		<add key="WeChat_MP_AppSecret" value="296c3e599e7574c5694c639d78d3ea33" />

		<add key="WeChat_MP_LoginURI" value="https://mp.weixin.qq.com/cgi-bin/login?lang=zh_CN" />
		<add key="WeChat_MP_GetAccessTokenURI" value="https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid={0}&amp;secret={1}" />
		<add key="WeChat_MP_GenerateQRCodeTicketURI" value="https://api.weixin.qq.com/cgi-bin/qrcode/create?access_token={0}" />
		<add key="WeChat_MP_GenerateQRCodeURI" value="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket={0}" />
		<add key="WeChat_MP_GetUserInfoURI" value="https://api.weixin.qq.com/cgi-bin/user/info?access_token={0}&amp;openid={1}" />
		<add key="WeChat_MP_GetUserListURI" value="https://api.weixin.qq.com/cgi-bin/user/get?access_token={0}"/>
		<add key="WeChat_MP_SendMessageURI" value="https://api.weixin.qq.com/cgi-bin/message/custom/send?access_token={0}"/>

		<add key="WeChat_MP_OAuth2_AuthURI" value="https://open.weixin.qq.com/connect/oauth2/authorize?appid={0}&amp;redirect_uri={1}&amp;response_type=code&amp;scope={2}&amp;state={3}#wechat_redirect" />
		<add key="WeChat_MP_OAuth2_GetAccessTokenURI" value="https://api.weixin.qq.com/sns/oauth2/access_token?appid={0}&amp;secret={1}&amp;code={2}&amp;grant_type=authorization_code" />
		<add key="WeChat_MP_OAuth2_RefAccessTokenURI" value="https://api.weixin.qq.com/sns/oauth2/refresh_token?appid={0}&amp;grant_type=refresh_token&amp;refresh_token={1}" />
		<add key="WeChat_MP_OAuth2_GetUserInfoURI" value="https://api.weixin.qq.com/sns/userinfo?access_token={0}&amp;openid={1}&amp;lang=zh_CN" />

		<add key="WeChat_MP_APIExecutor_MaxNum" value="3"/>
		<!-- End -->

		<!-- 保险 -->
		<add key="Insurance_Settings_SystemName" value="KuaiPin"/>
		<add key="Insurance_Settings_OccupationCode" value="0001001"/>
		<add key="Insurance_Settings_PresentCode" value="PC0000000120"/>
		<add key="Insurance_Settings_TSRCode" value="805095"/>
		<add key="Insurance_Settings_SMSEnabled" value="true"/>

		<add key="Insurance_Settings_Service_URI_Metlife" value="http://icare-uat.metlife.com.cn/services/YSW2ICareSave"/>
		<!-- End -->

		<add key="ClientSettingsProvider.ServiceUri" value="" />
		<add key="ClientSettingsProvider.ConnectionStringName" value="DefaultConnection" />
	</appSettings>

	<hostServiceSettings>
		<add name="RepositoryService" type="SNS.Apps.KPC.Libs.Services.RepositoryService, SNS.Apps.KPC.Libs.Services, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
		<add name="RouteMatrixService" type="SNS.Apps.KPC.Libs.Services.RouteMatrixService, SNS.Apps.KPC.Libs.Services, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
		<add name="InsuranceService" type="SNS.Apps.KPC.Libs.Services.InsuranceService, SNS.Apps.KPC.Libs.Services, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
		<add name="WeChatService" type="SNS.Apps.KPC.Libs.Services.WeChatService, SNS.Apps.KPC.Libs.Services, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
		<add name="SMSService" type="SNS.Apps.KPC.Libs.Services.SMSService, SNS.Apps.KPC.Libs.Services, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
		<add name="LogService" type="SNS.Apps.KPC.Libs.Services.LogService, SNS.Apps.KPC.Libs.Services, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
		<add name="ConsoleService" type="SNS.Apps.KPC.Libs.Services.ConsoleService, SNS.Apps.KPC.Libs.Services, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
	</hostServiceSettings>

	<taskServiceSettings>
		<add name="RouteMatrixMaintainService" type="SNS.Apps.KPC.Libs.Tasks.RouteMatrixMaintainTask, SNS.Apps.KPC.Libs.Tasks, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
		<add name="UserOrderMaintainService" type="SNS.Apps.KPC.Libs.Tasks.UserOrderMaintainTask, SNS.Apps.KPC.Libs.Tasks, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" executeTime="03:30:00" isEnabled="false" />
		<add name="UserInsuranceMaintainService" type="SNS.Apps.KPC.Libs.Tasks.UserInsuranceMaintainTask, SNS.Apps.KPC.Libs.Tasks, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" executeTime="00:00:00" />
	</taskServiceSettings>

	<smsServiceSettings>
		<add channel="0" name="短信通道 0（上海）" serviceEntry="http://www.ldsms.com/SmsServiceUTF.asmx" userName="iek-8115" password="zck2012" />
		<add channel="1" name="短信通道 1（上海互艺）" serviceEntry="http://106.ihuyi.com/webservice/sms.php?method=Submit" userName="cf_kuaipc" password="kuaipc123" />
		<add channel="2" name="短信通道 2（北京）" serviceEntry="http://sdk2.sudas.cn:8060" userName="SDK-KEY-010-00064" password="599377" isEnabled="false" />
		<add channel="3" name="短信通道 3（安徽）" serviceEntry="http://http.yunsms.cn/tx" userName="53756" password="rg483n" isEnabled="false"/>
	</smsServiceSettings>

	<log4net>
		<logger name="SNS_Apps_FileLogger">
			<level value="ALL" />
			<appender-ref ref="RollingFileAppender"/>
		</logger>
		<logger name="SNS_Apps_DBLogger">
			<level value="ALL" />
			<appender-ref ref="DatabaseAppender_SQL"/>
		</logger>
		<appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
			<file value="Log\log.test.data" />
			<appendToFile value="true" />
			<rollingStyle value="Size" />
			<maxSizeRollBackups value="10" />
			<maximumFileSize value="4096KB" />
			<staticLogFileName value="true" />
			<layout type="log4net.Layout.PatternLayout">
				<conversionPattern value="%date [Thread: %thread]%newline%-5level [Line: %line, Class: %class, File: %file]%newline%message%newline%newline%newline" />
			</layout>
		</appender>
		<appender name="DatabaseAppender_SQL" type="log4net.Appender.AdoNetAppender">
			<connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=2.0.0.0, Culture=Neutral, PublicKeyToken=b77a5c561934e089"/>
			<connectionString value="data source=.;initial catalog=SNS.Apps.KPC.V2.Log;integrated security=True;MultipleActiveResultSets=True;"/>
			<commandText value="INSERT INTO dbo.tbl_Log_Service ([Level], [Thread], [Message], [CreateDate]) VALUES (@Level, @Thread, @Message, @CreateDate)"/>
			<bufferSize value="3"/>
			<parameter>
				<parameterName value="@Level"/>
				<dbType value="String"/>
				<size value="50"/>
				<layout type="log4net.Layout.PatternLayout">
					<conversionPattern value="%level"/>
				</layout>
			</parameter>
			<parameter>
				<parameterName value="@Thread"/>
				<dbType value="String"/>
				<size value="50"/>
				<layout type="log4net.Layout.PatternLayout">
					<conversionPattern value="%thread"/>
				</layout>
			</parameter>
			<parameter>
				<parameterName value="@Message"/>
				<dbType value="String"/>
				<size value="3000"/>
				<layout type="log4net.Layout.PatternLayout">
					<conversionPattern value="%message"/>
				</layout>
			</parameter>
			<parameter>
				<parameterName value="@CreateDate"/>
				<dbType value="DateTime"/>
				<layout type="log4net.Layout.RawTimeStampLayout"/>
			</parameter>
		</appender>
	</log4net>

	<entityFramework>
		<defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
			<parameters>
				<parameter value="v11.0" />
			</parameters>
		</defaultConnectionFactory>
		<providers>
			<provider invariantName="System.Data.SqlClient" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer" />
		</providers>
	</entityFramework>

	<system.serviceModel>
		<services>
			<service name="SNS.Apps.KPC.Libs.Services.RepositoryService">
				<endpoint address="" binding="netTcpBinding" behaviorConfiguration="netTcpServiceBehavior" contract="SNS.Apps.KPC.Libs.IServices.IRepositoryService" />
				<endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
				<host>
					<baseAddresses>
						<add baseAddress="net.tcp://localhost/api.kuaipinche.com/RepositoryService" />
					</baseAddresses>
				</host>
			</service>
			<service name="SNS.Apps.KPC.Libs.Services.RouteMatrixService">
				<endpoint address="" binding="netTcpBinding" behaviorConfiguration="netTcpServiceBehavior" contract="SNS.Apps.KPC.Libs.IServices.IRouteMatrixService" />
				<endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
				<host>
					<baseAddresses>
						<add baseAddress="net.tcp://localhost/api.kuaipinche.com/RouteMatrixService" />
					</baseAddresses>
				</host>
			</service>
			<service name="SNS.Apps.KPC.Libs.Services.InsuranceService">
				<endpoint address="" binding="netTcpBinding" behaviorConfiguration="netTcpServiceBehavior" contract="SNS.Apps.KPC.Libs.IServices.IInsuranceService" />
				<endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
				<host>
					<baseAddresses>
						<add baseAddress="net.tcp://localhost/api.kuaipinche.com/InsuranceService" />
					</baseAddresses>
				</host>
			</service>
			<service name="SNS.Apps.KPC.Libs.Services.WeChatService">
				<endpoint address="" binding="netTcpBinding" behaviorConfiguration="netTcpServiceBehavior" contract="SNS.Apps.KPC.Libs.IServices.IWeChatService" />
				<endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
				<host>
					<baseAddresses>
						<add baseAddress="net.tcp://localhost/api.kuaipinche.com/WeChatService" />
					</baseAddresses>
				</host>
			</service>
			<service name="SNS.Apps.KPC.Libs.Services.SMSService">
				<endpoint address="" binding="netTcpBinding" behaviorConfiguration="netTcpServiceBehavior" contract="SNS.Apps.KPC.Libs.IServices.ISMSService" />
				<endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
				<host>
					<baseAddresses>
						<add baseAddress="net.tcp://localhost/api.kuaipinche.com/SMSService" />
					</baseAddresses>
				</host>
			</service>
			<service name="SNS.Apps.KPC.Libs.Services.LogService">
				<endpoint address="" binding="netTcpBinding" behaviorConfiguration="netTcpServiceBehavior" contract="SNS.Apps.KPC.Libs.IServices.ILogService" />
				<endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
				<host>
					<baseAddresses>
						<add baseAddress="net.tcp://localhost/api.kuaipinche.com/LogService" />
					</baseAddresses>
				</host>
			</service>
			<service name="SNS.Apps.KPC.Libs.Services.ConsoleService">
				<endpoint address="" binding="netTcpBinding" behaviorConfiguration="netTcpServiceBehavior" contract="SNS.Apps.KPC.Libs.IServices.IConsoleService" />
				<endpoint address="mex" binding="mexTcpBinding" contract="IMetadataExchange" />
				<host>
					<baseAddresses>
						<add baseAddress="net.tcp://localhost/api.kuaipinche.com/ConsoleService" />
					</baseAddresses>
				</host>
			</service>
		</services>
		<behaviors>
			<serviceBehaviors>
				<behavior name="">
					<serviceMetadata httpGetEnabled="false" httpsGetEnabled="false" />
					<serviceDebug includeExceptionDetailInFaults="true" />
				</behavior>
			</serviceBehaviors>
			<endpointBehaviors>
				<behavior name="netTcpServiceBehavior">
				</behavior>
			</endpointBehaviors>
		</behaviors>
		<client>
			<endpoint address="net.tcp://localhost/api.kuaipinche.com/WeChatService" binding="netTcpBinding" bindingConfiguration="netTcpBindingConfig" behaviorConfiguration="netTcpServiceBehavior" contract="SNS.Apps.KPC.Libs.IServices.IWeChatService" name="wechatService" />
			<endpoint address="net.tcp://localhost/api.kuaipinche.com/SMSService" binding="netTcpBinding" bindingConfiguration="netTcpBindingConfig" behaviorConfiguration="netTcpServiceBehavior" contract="SNS.Apps.KPC.Libs.IServices.ISMSService" name="smsService" />
			<endpoint address="http://icare-uat.metlife.com.cn/services/YSW2ICareSave" binding="basicHttpBinding" bindingConfiguration="YSW2ICareSaveSoapBinding" contract="InsuranceService_Metlife_Ref.YSW2ICareSave" name="insuranceService_Metlife" />
		</client>
		<bindings>
			<basicHttpBinding>
				<binding name="YSW2ICareSaveSoapBinding" />
			</basicHttpBinding>
			<netTcpBinding>
				<binding name="netTcpBindingConfig" closeTimeout="00:10:00" openTimeout="00:10:00" receiveTimeout="00:10:00" sendTimeout="00:10:00" maxConnections="1000" maxReceivedMessageSize="2147483647">
					<security>
						<transport clientCredentialType="Windows" protectionLevel="EncryptAndSign" />
					</security>
				</binding>
			</netTcpBinding>
		</bindings>
		<serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="false" minFreeMemoryPercentageToActivateService="0" />
	</system.serviceModel>

	<system.web>
		<membership defaultProvider="ClientAuthenticationMembershipProvider">
			<providers>
				<add name="ClientAuthenticationMembershipProvider" type="System.Web.ClientServices.Providers.ClientWindowsAuthenticationMembershipProvider, System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" serviceUri="" connectionStringName="DefaultConnection" credentialsProvider="" />
			</providers>
		</membership>
		<roleManager defaultProvider="ClientRoleProvider" enabled="true">
			<providers>
				<add name="ClientRoleProvider" type="System.Web.ClientServices.Providers.ClientRoleProvider, System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" serviceUri="" cacheTimeout="86400" connectionStringName="DefaultConnection" />
			</providers>
		</roleManager>
	</system.web>
</configuration>