<?xml version="1.0" encoding="utf-8"?>
<configuration>
	<configSections>
		<section name="log4net" type="System.Configuration.IgnoreSectionHandler" />
		<section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
		<section name="smsServiceSettings" type="SNS.Apps.KPC.Libs.Configurations.SMSServiceConfiguration, SNS.Apps.KPC.Libs.Configurations, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null" />
	</configSections>

	<startup>
		<supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" />
	</startup>

	<connectionStrings>
		<add name="DataModels" connectionString="metadata=res://*/DataStores.DataModels.csdl|res://*/DataStores.DataModels.ssdl|res://*/DataStores.DataModels.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=.;initial catalog=SNS.Apps.KPC.V2;integrated security=True;multipleactiveresultsets=True;application name=EntityFramework&quot;" providerName="System.Data.EntityClient" />
	</connectionStrings>

	<appSettings>
		<!-- Common Settings -->
		<add key="WebRequest_UserAgent" value="Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/20100101 Firefox/26.0"/>
		<!-- End -->

		<!-- WeChat Service Settings -->
		<add key="WeChat_MP_Account" value="kuaipinche" />
		<add key="WeChat_MP_Password" value="Kuai_mp123" />

		<!-- 公众号 -->
		<add key="WeChat_MP_AppID" value="wxf20cdd91925855f1" />
		<add key="WeChat_MP_AppSecret" value="55fede0ceffdaafae48a5571a0fe717a" />
		<!-- 测试号 -->
		<!--
		<add key="WeChat_MP_AppID" value="wxd946f6039772215d" />
		<add key="WeChat_MP_AppSecret" value="296c3e599e7574c5694c639d78d3ea33" />
		-->

		<add key="WeChat_MP_LoginURI" value="https://mp.weixin.qq.com/cgi-bin/login?lang=zh_CN" />
		<add key="WeChat_MP_GetAccessTokenURI" value="https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&amp;appid={0}&amp;secret={1}" />
		<add key="WeChat_MP_GenerateQRCodeTicketURI" value="https://api.weixin.qq.com/cgi-bin/qrcode/create?access_token={0}" />
		<add key="WeChat_MP_GenerateQRCodeURI" value="https://mp.weixin.qq.com/cgi-bin/showqrcode?ticket={0}" />
		<add key="WeChat_MP_GetUserInfoURI" value="https://api.weixin.qq.com/cgi-bin/user/info?access_token={0}&amp;openid={1}" />
		<add key="WeChat_MP_GetUserListURI" value="https://api.weixin.qq.com/cgi-bin/user/get?access_token={0}"/>

		<add key="WeChat_MP_OAuth2_AuthURI" value="https://open.weixin.qq.com/connect/oauth2/authorize?appid={0}&amp;redirect_uri={1}&amp;response_type=code&amp;scope={2}&amp;state=1#wechat_redirect" />
		<add key="WeChat_MP_OAuth2_GetAccessTokenURI" value="https://api.weixin.qq.com/sns/oauth2/access_token?appid={0}&amp;secret={1}&amp;code={2}&amp;grant_type=authorization_code" />
		<add key="WeChat_MP_OAuth2_RefAccessTokenURI" value="https://api.weixin.qq.com/sns/oauth2/refresh_token?appid={0}&amp;grant_type=refresh_token&amp;refresh_token={1}" />
		<add key="WeChat_MP_OAuth2_GetUserInfoURI" value="https://api.weixin.qq.com/sns/userinfo?access_token={0}&amp;openid={1}&amp;lang=zh_CN" />
		<!-- End -->
	</appSettings>

	<log4net>
		<logger name="SNS_Apps_FileLogger">
			<level value="ALL" />
			<appender-ref ref="RollingFileAppender"/>
		</logger>
		<logger name="SNS_Apps_DBLogger">
			<level value="ALL" />
			<appender-ref ref="DatabaseAppender_SQL"/>
		</logger>
		<appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
			<file value="Log\log.test.data" />
			<appendToFile value="true" />
			<rollingStyle value="Size" />
			<maxSizeRollBackups value="10" />
			<maximumFileSize value="4096KB" />
			<staticLogFileName value="true" />
			<layout type="log4net.Layout.PatternLayout">
				<conversionPattern value="%date [Thread: %thread]%newline%-5level [Line: %line, Class: %class, File: %file]%newline-%message%newline%newline%newline" />
			</layout>
		</appender>
		<appender name="DatabaseAppender_SQL" type="log4net.Appender.AdoNetAppender">
			<connectionType value="System.Data.SqlClient.SqlConnection, System.Data, Version=2.0.0.0, Culture=Neutral, PublicKeyToken=b77a5c561934e089"/>
			<connectionString value="data source=.;initial catalog=SNS.Apps.KPC.V2.Log;integrated security=True;MultipleActiveResultSets=True;"/>
			<commandText value="INSERT INTO dbo.tbl_Log_App ([Level], [Thread], [Line], [Class], [File], [UserID], [UserName], [Message], [CreateDate]) VALUES (@Level, @Thread, @Line, @Class, @File, @UserID, @UserName, @Message, @CreateDate)"/>
			<bufferSize value="5"/>
			<parameter>
				<parameterName value="@Level"/>
				<dbType value="String"/>
				<size value="50"/>
				<layout type="log4net.Layout.PatternLayout">
					<conversionPattern value="%level"/>
				</layout>
			</parameter>
			<parameter>
				<parameterName value="@Thread"/>
				<dbType value="String"/>
				<size value="50"/>
				<layout type="log4net.Layout.PatternLayout">
					<conversionPattern value="%thread"/>
				</layout>
			</parameter>
			<parameter>
				<parameterName value="@Line"/>
				<dbType value="String"/>
				<size value="50"/>
				<layout type="log4net.Layout.PatternLayout">
					<conversionPattern value="%line"/>
				</layout>
			</parameter>
			<parameter>
				<parameterName value="@Class"/>
				<dbType value="String"/>
				<size value="300"/>
				<layout type="log4net.Layout.PatternLayout">
					<conversionPattern value="%class"/>
				</layout>
			</parameter>
			<parameter>
				<parameterName value="@File"/>
				<dbType value="String"/>
				<size value="300"/>
				<layout type="log4net.Layout.PatternLayout">
					<conversionPattern value="%file"/>
				</layout>
			</parameter>
			<parameter>
				<parameterName value="@UserID"/>
				<dbType value="String"/>
				<size value="50"/>
				<layout type="SNS.Apps.KPC.Libs.Utils.Logger.Layout.UserPersisterLayout">
					<conversionPattern value="%userid"/>
				</layout>
			</parameter>
			<parameter>
				<parameterName value="@UserName"/>
				<dbType value="String"/>
				<size value="50"/>
				<layout type="SNS.Apps.KPC.Libs.Utils.Logger.Layout.UserPersisterLayout">
					<conversionPattern value="%username"/>
				</layout>
			</parameter>
			<parameter>
				<parameterName value="@Message"/>
				<dbType value="String"/>
				<size value="3000"/>
				<layout type="log4net.Layout.PatternLayout">
					<conversionPattern value="%message"/>
				</layout>
			</parameter>
			<parameter>
				<parameterName value="@CreateDate"/>
				<dbType value="DateTime"/>
				<layout type="log4net.Layout.RawTimeStampLayout"/>
			</parameter>
		</appender>
	</log4net>

	<smsServiceSettings>
		<add channel="0" name="短信通道 0" serviceEntry="http://www.ldsms.com/SmsServiceUTF.asmx" userName="iek-8115" password="zck2012" />
		<add channel="1" name="短信通道 1" serviceEntry="http://http.yunsms.cn/tx/" userName="53756" password="rg483n"/>
	</smsServiceSettings>

	<entityFramework>
		<defaultConnectionFactory type="System.Data.Entity.Infrastructure.LocalDbConnectionFactory, EntityFramework">
			<parameters>
				<parameter value="v11.0" />
			</parameters>
		</defaultConnectionFactory>
		<providers>
			<provider invariantName="System.Data.SqlClient" type="System.Data.Entity.SqlServer.SqlProviderServices, EntityFramework.SqlServer" />
		</providers>
	</entityFramework>

	<system.serviceModel>
		<client>
   <endpoint address="net.tcp://localhost/api.kuaipinche.com/RepositoryService"
    behaviorConfiguration="netTcpServiceBehavior" binding="netTcpBinding"
    bindingConfiguration="netTcpBindingConfig" contract="SNS.Apps.KPC.Libs.IServices.IRepositoryService"
    name="repositoryService" />
   <endpoint address="net.tcp://localhost/api.kuaipinche.com/RouteMatrixService"
    behaviorConfiguration="netTcpServiceBehavior" binding="netTcpBinding"
    bindingConfiguration="netTcpBindingConfig" contract="SNS.Apps.KPC.Libs.IServices.IRouteMatrixService"
    name="routeMatrixService" />
   <endpoint address="net.tcp://localhost/api.kuaipinche.com/WeChatService"
    behaviorConfiguration="netTcpServiceBehavior" binding="netTcpBinding"
    bindingConfiguration="netTcpBindingConfig" contract="SNS.Apps.KPC.Libs.IServices.IWeChatService"
    name="wechatService" />
   <endpoint address="net.tcp://localhost/api.kuaipinche.com/SMSService"
    behaviorConfiguration="netTcpServiceBehavior" binding="netTcpBinding"
    bindingConfiguration="netTcpBindingConfig" contract="SNS.Apps.KPC.Libs.IServices.ISMSService"
    name="smsService" />
   <endpoint address="http://icare-uat.metlife.com.cn/services/YSW2ICareSave"
    binding="basicHttpBinding" bindingConfiguration="YSW2ICareSaveSoapBinding"
    contract="MetLisfeService.YSW2ICareSave" name="YSW2ICareSave" />
  </client>
		<bindings>
   <basicHttpBinding>
    <binding name="YSW2ICareSaveSoapBinding" />
   </basicHttpBinding>
   <netTcpBinding>
    <binding name="netTcpBindingConfig" closeTimeout="00:10:00" openTimeout="00:10:00"
     receiveTimeout="00:10:00" sendTimeout="00:10:00" maxConnections="1000"
     maxReceivedMessageSize="2147483647" />
   </netTcpBinding>
  </bindings>
		<behaviors>
			<endpointBehaviors>
				<behavior name="netTcpServiceBehavior">
				</behavior>
			</endpointBehaviors>
		</behaviors>
		<serviceHostingEnvironment aspNetCompatibilityEnabled="true" multipleSiteBindingsEnabled="false" minFreeMemoryPercentageToActivateService="0" />
	</system.serviceModel>

	<runtime>
		<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
			<dependentAssembly>
				<assemblyIdentity name="Microsoft.Owin" publicKeyToken="31bf3856ad364e35" culture="neutral" />
				<bindingRedirect oldVersion="0.0.0.0-2.0.2.0" newVersion="2.0.2.0" />
			</dependentAssembly>
			<dependentAssembly>
				<assemblyIdentity name="Microsoft.Owin.Security" publicKeyToken="31bf3856ad364e35" culture="neutral" />
				<bindingRedirect oldVersion="0.0.0.0-2.0.2.0" newVersion="2.0.2.0" />
			</dependentAssembly>
		</assemblyBinding>
	</runtime>
</configuration>