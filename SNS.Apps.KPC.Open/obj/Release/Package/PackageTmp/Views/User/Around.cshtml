@{
    Layout = "~/Views/Shared/_LayoutPage_Map.cshtml";
    ViewBag.Title = "快拼车";
}
@Styles.Render("~/Content/route/listview")
<style>
    #shade_bottom {
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: black;
        opacity: 0.7;
        filter: alpha(opacity=70);
        -moz-opacity: 0.7;
        z-index: 1001;
    }

    #shade_top_div {
        display: none;
        position: absolute;
        top: 25%;
        left: 10%;
        width: 80%;
        height: auto;
        padding: 8px;
        border: 1px solid #E8E9F7;
        background-color: white;
        overflow: auto;
        z-index: 1002;
    }
</style><!-- /Style -->
@RenderPage("/Views/Shared/_Navbar.cshtml")
<div id="wrapper">
    <div class="header">
        <span id="navbar" class="headermenu"></span>
        <a href="/user/aroundList" style="position:absolute;color: white; text-decoration: none; cursor: pointer;right: 10px">列表模式</a>
        <span id="div_location" style="position: absolute; left: 45%">正在加载中</span>
    </div>

    <div id="map_canvas"></div><!-- /Map -->

    <div id="shade_bottom">
    </div>
    <div id="shade_top_div">
        <table style="width: 100%; height: 100%;">
            <tr>
                <td>
                    <div id="shade_top">
                    </div>
                </td>
            </tr>
            <tr>
                <td>
                    <div style="text-align: center; padding: 10px 0; background-color: #dd4500; color: white" id="btnclose">关闭</div>
                </td>
            </tr>
        </table><!-- /Info -->
    </div><!-- /Shade -->
</div>
@section Scripts
{
    <script type="text/javascript" src="http://api.map.baidu.com/library/TextIconOverlay/1.2/src/TextIconOverlay_min.js"></script>
    <script type="text/javascript" src="http://api.map.baidu.com/library/MarkerClusterer/1.2/src/MarkerClusterer_min.js"></script>

    @if (ViewBag.UserTrack != null)
    {
        <script type="text/javascript">
            var KPC = KPC || {};
            KPC.Around = {};
            KPC.Around.user_point = {
                lat: parseFloat("@ViewBag.UserTrack.Position.Latitude"),
                lng: parseFloat("@ViewBag.UserTrack.Position.Longitude")
            };
            KPC.Around._userID = "@ViewBag.UserGUID";
        </script>
        @Scripts.Render("~/bundles/user/around")
    }
    else if (ViewBag.ErrorMsg != null)
    {
        <script type="text/javascript">
            alert("@ViewBag.ErrorMsg");
        </script>
    }
    <script>
        (function () {
            document.getElementById("navbar").addEventListener("click", function (e) {
                if (document.documentElement.style.position !== "fixed") {
                    document.getElementById("nav").style.display = "block";
                    document.getElementById("wrapper").className = "nav";
                    document.documentElement.style.position = "fixed";
                } else {
                    document.body.click();
                }
                e.stopPropagation();
            });
            document.body.addEventListener("click", function () {
                if (document.getElementById("nav").style.display === "block") {
                    document.getElementById("nav").style.display = "none";
                    document.getElementById("wrapper").className = "";
                    document.documentElement.style.position = "";
                }
            });
        })();
    </script>
}
